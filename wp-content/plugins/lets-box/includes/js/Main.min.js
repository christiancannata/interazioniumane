function sendAnalyticsLB(e,t){"1"===LetsBox_vars.google_analytics&&("undefined"!=typeof ga&&null!==ga&&ga("send","event","Lets-Box",e,t),"undefined"!=typeof _gaq&&null!==_gaq&&_gaq.push(["_trackEvent","Lets-Box",e,t]),"undefined"!=typeof gtag&&null!==gtag&&gtag("event",e,{event_category:"Lets-Box",event_label:t,value:t}))}jQuery(document).ready(function(e){"use strict";e.widget("cp.LetsBox",{options:{listtoken:null,searchQuery:null},_create:function(){var t=this;if(this.element.removeClass("jsdisabled"),this.element.show(),this.element.on("contextmenu",function(e){return!1}),this.options.main=this,this.options.topContainer=this.element.parent(),this.options.loadingContainer=this.element.find(".loading"),this.element.css("width","100%"),this.options.listtoken=this.element.attr("data-token"),this.options.instance_action=this.element.attr("data-action"),this.searchQuery=this.element.attr("data-query"),this.cache={},this.xhrPool=[],this.xhrPool.abortAll=function(){e(this).each(function(e,t){t.abort()}),t.xhrPool.length=0},this.options.userAgent=navigator.userAgent||navigator.vendor||window.opera,this.options.supportTouch=!!("ontouchstart"in window)&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(this.options.userAgent)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1,this.options.mobile=!1,/Android|webOS|iPhone|iPod|iPad|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)){var o=navigator.userAgent.toLowerCase();o.search("android")>-1&&o.search("mobile")>-1?this.options.mobile=!0:o.search("android")>-1&&!(o.search("mobile")>-1)?this.options.mobile=!1:this.options.mobile=!0}else"1"===this.options.is_mobile&&(this.options.mobile=!0);this.options.mobile&&e("html").addClass("wpcp-mobile"),this.is_rtl="rtl"===window.getComputedStyle(document.body,null).getPropertyValue("direction"),t._initCache(),""===this.options.recaptcha?this._initiate():this._checkReCaptcha(this)},_destroy:function(){return this._super()},_setOption:function(e,t){this._super(e,t)},_initiate:function(){var t=this;t.options.topContainer.one("inview",function(e,o){t._initResizeHandler(),t._initLazyLoad(),(t.options.topContainer.hasClass("files")||t.options.topContainer.hasClass("gallery")||t.options.topContainer.hasClass("search"))&&(t._initFilebrowser(),t.options.topContainer.hasClass("gallery")&&t.renderContentForGallery()),(t.options.topContainer.hasClass("video")||t.options.topContainer.hasClass("audio"))&&t._initMediaPlayer(),t.element.find(".fileupload-box").length>0&&t._initUploadBox()});var o=new URL(window.location),n=new URLSearchParams(o.search),i=n.get("wpcp_link");if(null!==i){var a=JSON.parse(decodeURIComponent(window.atob(i)));a.source===this.element.attr("data-source")&&t.options.topContainer.addClass("initiate")}t.options.topContainer.hasClass("initiate")&&t.options.topContainer.trigger("inview"),window.setTimeout(function(){t.initated=!0},2e3),t.element.trigger("letsbox-loaded",t),e(window).on("beforeunload",function(){t.xhrPool.abortAll()})},_initFilebrowser:function(){var e=this;e._initNavMenu(),e._initBrowserViewActions(),e._initEntryMenuActions(),e._initScrollToTop(),e._initImageFolderThumbActions();var t={},o=new URL(window.location),n=new URLSearchParams(o.search),i=n.get("wpcp_link");if(null!==i){var a=JSON.parse(decodeURIComponent(window.atob(i)));a.source===e.element.attr("data-source")&&(e.options.account_id=a.account_id,e.element.attr("data-id",a.lastFolder),e.element.attr("data-account-id",a.account_id),e.element.attr("data-path",a.folderPath),e.option.focus_id=a.focus_id)}var l=e._cacheGet("WPCP_"+e.options.listtoken+"_viewer");null!==l&&e.element.attr("data-layout",l.value),!1!==e.options.topContainer.hasClass("search")&&null===e.searchQuery||e._getFileList(t)},_initMediaPlayer:function(){var e=this;window.init_lets_box_media_player(e.options.listtoken)},_initUploadBox:function(){var e=this;e.element.find(".fileupload-box").LetsBoxUploadbox(e.options)},_getFileList:function(e){var t=this,o=t._buildFileListRequest();t.element.removeClass("wpcp-no-results"),t.options.loadingContainer.removeClass("initialize upload error").fadeIn(400),t.element.find(".nav-refresh i").addClass("eva-spin eva-spin-center"),o(e,t)},_buildFileListRequest:function(e){var t=this;return this._pipeline({url:t.options.ajax_url,type:"POST",dataType:"json",data:function(e){return e.listtoken=t.options.listtoken,e.lastFolder=t.element.attr("data-id"),e.folderPath=t.element.attr("data-path"),e.sort=t.element.attr("data-sort"),e.deeplink=t.element.attr("data-deeplink"),e.action="letsbox-get-filelist",e._ajax_nonce=t.options.refresh_nonce,e.mobile=t.options.mobile,"gallery"===t.element.attr("data-list")&&(e.action="letsbox-get-gallery",e.type="gallery",e._ajax_nonce=t.options.gallery_nonce),e.query=t.searchQuery,e}})},_initSearchBox:function(){var t=this,o=t.element[0].querySelector(".nav-search"),n=t.element[0].querySelector(".search-div");null!=n&&(null!=o?(e(o).on("click",function(e){e.stopPropagation()}),n.classList.remove("tippy-content-holder"),tippy(o,{trigger:"click",arrow:!1,offset:0,content:n,allowHTML:!0,placement:t.is_rtl?"bottom-start":"bottom-end",appendTo:t.element[0],moveTransition:"transform 0.2s ease-out",interactive:!0,interactiveDebounce:500,theme:"wpcloudplugins-"+t.options.content_skin,onShown:function(t){e("input",t.popper).focus()},onCreate:function(o){t._initSearchBoxActions(e(o.popper))}})):t._initSearchBoxActions(t.element))},_initSearchBoxActions:function(t){var o=this;t.find(".search-input").on("keyup",function(t){o.searchQuery=e(this).val().replace(/(<([^>]+)>)/gi,""),e(this).val().length>0?(o.options.loadingContainer.addClass("search"),o.element.find(".nav-search").addClass("inuse"),clearTimeout(o.updateTimer),o.updateTimer=setTimeout(function(){o.element.find(".loading, .ajax-filelist").show(),o._getFileList({})},1e3)):(o.element.find(".nav-search").removeClass("inuse"),o.element.hasClass("searchlist")?(o.element.find(".loading, .ajax-filelist").hide(),o.element.find(".ajax-filelist").html("")):o._getFileList({}))}),t.find(".submit-search").on("click",function(e){t.find(".search-input").trigger("keyup")}),t.find(".search-remove").on("click",function(e){o.clearSearchBox()}),t.find(".search-input").val(o.searchQuery)},clearSearchBox:function(e){var t=this;t.searchQuery="",t.element.find(".search-input").val(""),void 0===e&&t.element.find(".search-input").trigger("keyup")},_initNavActionMenu:function(){var t=this,o=t.element[0].querySelector(".nav-gear"),n=t.element[0].querySelector(".gear-div");null!=n&&null!=o&&(e(o).on("click",function(e){e.stopPropagation()}),n.classList.remove("tippy-content-holder"),tippy(o,{trigger:"click",arrow:!1,offset:0,content:n,maxWidth:350,allowHTML:!0,placement:t.is_rtl?"bottom-start":"bottom-end",appendTo:t.element[0],moveTransition:"transform 0.2s ease-out",interactive:!0,theme:"wpcloudplugins-"+t.options.content_skin,onShow:function(e){t._initNavActionMenuEvents(e)}}))},_initNavActionMenuEvents:function(t){var o=this,n=e("<div>").attr("data-id",o.element.attr("data-id"));switch(e(t.popper).find(".nav-layout").off("click").on("click",function(e){t.hide(),"list"===o.element.attr("data-layout")?o.element.attr("data-layout","grid"):o.element.attr("data-layout","list"),o._cacheSet("WPCP_"+o.options.listtoken+"_viewer",{expires:null,value:o.element.attr("data-layout")}),o._getFileList({})}),o.element.attr("data-layout")){case"list":e(t.popper).find(".nav-layout-grid").closest("li").show(),e(t.popper).find(".nav-layout-list").closest("li").hide();break;case"grid":e(t.popper).find(".nav-layout-grid").closest("li").hide(),e(t.popper).find(".nav-layout-list").closest("li").show()}var i=o._helperReadArrCheckBoxes("[data-token='"+o.options.listtoken+"'] input[name='selected-files[]']");0===i.length?(e(t.popper).find(".selected-files-to-zip").parent().hide(),e(t.popper).find(".all-files-to-zip").parent().show(),e(t.popper).find(".selected-files-delete").parent().hide(),e(t.popper).find(".selected-files-move").parent().hide()):(e(t.popper).find(".selected-files-to-zip").parent().show(),e(t.popper).find(".all-files-to-zip").parent().hide(),e(t.popper).find(".selected-files-delete").parent().show(),e(t.popper).find(".selected-files-move").parent().show());var a=e(t.popper).find("ul > li").not(".gear-menu-no-options").filter(function(){return"none"!==e(this).css("display")});a.length>0?e(t.popper).find(".gear-menu-no-options").hide():e(t.popper).find(".gear-menu-no-options").show(),e(t.popper).find(".all-files-to-zip, .selected-files-to-zip").off("click").on("click",function(n){t.hide();var i=[];e(n.target).hasClass("all-files-to-zip")&&(i=[o.element.attr("data-id")]),e(n.target).hasClass("selected-files-to-zip")&&(i=o._helperReadArrCheckBoxes("[data-token='"+o.options.listtoken+"'] input[name='selected-files[]']")),o._actionDownloadZip(i,n)}),e(t.popper).find(".nav-upload").on("click",function(n){t.hide();var i=o.element.find(".fileupload-box");e("html, body").animate({scrollTop:i.offset().top},1500);for(var a=0;a<3;a++)i.find(".fileupload-buttonbar").fadeTo("slow",.5).fadeTo("slow",1)}),e(t.popper).find(".newentry").off("click").on("click",function(i){if(t.hide(),void 0!==o.searchQuery&&""!==o.searchQuery)return!1;o._actionCreateEntry(n,e(this).data("mimetype"),i)}),e(t.popper).find(".newfolder").off("click").on("click",function(i){if(t.hide(),void 0!==o.searchQuery&&""!==o.searchQuery)return!1;o._actionCreateEntry(n,e(this).data("mimetype"),i)}),!0===o.element.data("selected-all")?e(t.popper).find(".select-all").parent().hide().next().show():e(t.popper).find(".deselect-all").parent().hide().prev().show(),e(t.popper).find(".select-all").on("click",function(n){t.hide(),o.element.find(".selected-files:checkbox").prop("checked",!0),o.element.find('.entry:not(".newfolder"):not(".pf")').addClass("isselected"),o.element.data("selected-all",!0),e(this).parent().hide().next().show()}),e(t.popper).find(".deselect-all").on("click",function(n){t.hide(),o.element.find(".selected-files:checkbox").prop("checked",!1),o.element.find('.entry:not(".newfolder"):not(".pf")').removeClass("isselected"),o.element.data("selected-all",!1),e(this).parent().hide().prev().show()}),e(t.popper).find(".selected-files-move").on("click",function(e){t.hide();var n=o.element.find("input[name='selected-files[]']:checked");if(0===n.length)return!1;o._actionMoveEntries(n,e)}),e(t.popper).find(".selected-files-delete").on("click",function(e){t.hide();var n=o.element.find("input[name='selected-files[]']:checked");if(0===n.length)return!1;o._actionDeleteEntries(n,e)}),e(t.popper).find(".entry_action_deeplink_folder").off("click").on("click",function(e){t.hide(),o._actionCreateDeepLink(n,e)}),e(t.popper).find(".entry_action_shortlink_folder").off("click").on("click",function(e){t.hide(),o._actionShareEntry(n,e)})},_initSortMenu:function(){var t=this,o=t.element[0].querySelector(".nav-sort"),n=t.element[0].querySelector(".sort-div");null!=n&&null!=o&&(e(o).on("click",function(e){e.stopPropagation()}),n.classList.remove("tippy-content-holder"),tippy(o,{trigger:"click",arrow:!1,offset:0,content:n,maxWidth:350,allowHTML:!0,placement:t.is_rtl?"bottom-start":"bottom-end",appendTo:t.element[0],moveTransition:"transform 0.2s ease-out",interactive:!0,theme:"wpcloudplugins-"+t.options.content_skin,onShow:function(e){t._initSortEvents(e)}}))},_initSortEvents:function(t){var o=this;e(t.popper).find(".nav-sorting-field").off("click").on("click",function(n){e(t.popper).find(".nav-sorting-field").removeClass("sort-selected"),e(this).addClass("sort-selected");var i=e(t.popper).find(".nav-sorting-field.sort-selected").data("field")+":"+e(t.popper).find(".nav-sorting-order.sort-selected").data("order");o.element.attr("data-sort",i),o._getFileList({}),tippy.hideAll()}),e(t.popper).find(".nav-sorting-order").off("click").on("click",function(n){e(t.popper).find(".nav-sorting-order").removeClass("sort-selected"),e(this).addClass("sort-selected");var i=e(t.popper).find(".nav-sorting-field.sort-selected").data("field")+":"+e(t.popper).find(".nav-sorting-order.sort-selected").data("order");o.element.attr("data-sort",i),o._getFileList({}),tippy.hideAll()})},_initBrowserViewActions:function(){var t=this;e(t.element).on({mouseenter:function(){e(this).addClass("hasfocus")},mouseleave:function(){e(this).removeClass("hasfocus")},mouseover:function(){e(this).addClass("hasfocus")},contextmenu:function(){return e(this).find(".entry-action-menu-button").trigger("click"),!1}},".entry"),e(t.element).on({click:function(o){if(e(this).hasClass("isdragged")||e(this).hasClass("newfolder"))return!1;if(!e(o.target).hasClass("entry-info-button")&&!e(o.target).parents(".entry-info-button").length){o.stopPropagation(),t.clearSearchBox(!1);var n={id:e(this).closest(".folder, .image-folder").attr("data-id")};t._getFileList(n),!1===t.element.find(".nav-header").visible(!0)&&e("html, body").stop().animate({scrollTop:t.element.offset().top-200},1e3)}}},".folder, .image-folder"),e(t.element).on({click:function(o){if(void 0!==t.searchQuery&&""!==t.searchQuery)return!1;t._actionCreateEntry(e(this),e(this).data("mimetype"),o)}},".newfolder"),e(t.element).on({click:function(o){if("embedded"===t.options.instance_action||"links"===t.options.instance_action)e(this).find(".entry_checkbox :checkbox").trigger("click"),o.stopPropagation();else if("shortcode"===t.options.instance_action);else{if(e(o.target).hasClass("entry_link"))return!0;var n=e(this).find("a.entry_link:first()");t.options.supportTouch&&n.hasClass("ilightbox-group")?n.trigger("itap"):n.length&&n[0].click()}}},".entry.file"),e(t.element).on({click:function(e){return e.stopPropagation(),!0}},".entry_checkbox"),e(t.element).on({click:function(o){var n=e(this).closest(".entry");if(o.ctrlKey||o.shiftKey){var i=t.element.find(".entry_checkbox input:checked").closest(".entry");n=i.first().nextUntil(i.last()).addBack().add(i.last()),n.find(".entry_checkbox input").prop("checked",!0)}e(this).prop("checked")?n.addClass("isselected"):n.removeClass("isselected"),o.stopPropagation()}},".entry_checkbox :checkbox")},renderBrowserContent:function(t){var o=this;if(e(".ajax-filelist").get(0).scrollTo(0,0),!1===t?(o.element.find(".nav-title").html(o.options.str_no_filelist),o.options.loadingContainer.addClass("error")):(o.options.loadingContainer.fadeIn(200),t.filescount||t.folderscount||o.element.addClass("wpcp-no-results"),o.element.find(".ajax-filelist").html(t.html),o.element.find(".image-collage").hide(),o.element.find(".nav-title").html(t.breadcrumb),o.element.find(".current-folder-raw").text(t.rawpath),null!==t.lastFolder&&o.element.attr("data-id",t.lastFolder),null!==t.folderPath&&o.element.attr("data-path",t.folderPath),o.element.removeClass("-is-virtual-folder"),!0===t.virtual&&o.element.addClass("-is-virtual-folder")),o.element.find(".wpcp-breadcrumb").one("inview",function(e,t){o.renderBreadCrumb()}),o.element.find(".nav-refresh i").removeClass("eva-spin eva-spin-center"),"grid"===o.element.attr("data-layout")&&o.element.find(".entry_thumbnail img.hidden").removeClass("hidden"),o.lazyload.update(),o.element.hasClass("wpcp-gallery")?(o.renderContentForGallery(),o._initLoadMore()):o.renderContentForBrowser(),o.lazyload.update(),o.element.data("selected-all",!1),o._initActionMenu(),o._initDescriptionBox(),o._initLightbox(),"list"===o.element.attr("data-layout")&&o._initThumbnailsPopup(),o._initMove(),o._initLinkEvent(),o.options.loadingContainer.fadeOut(300),void 0!==o.option.focus_id&&null!==o.option.focus_id){var n=o.element.find('.entry[data-id="'+o.option.focus_id+'"]');n.length&&(n.addClass("hasfocus"),n.find("a.ilightbox-group").length>0&&n.find("a.ilightbox-group").trigger("click"),e("html, body").animate({scrollTop:n.offset().top},1500)),o.option.focus_id=null}o.element.trigger("content-loaded",o)},renderContentForBrowser:function(){var e=this,t=e.element.find(".files");switch(this.element.attr("data-layout")){case"list":e.element.removeClass("wpcp-thumb-view").addClass("wpcp-list-view");break;case"grid":e.element.removeClass("wpcp-list-view").addClass("wpcp-thumb-view"),e.fitEntriesInContainer(t.find(".folders-container "),250),e.fitEntriesInContainer(t.find(".files-container "),250)}t.fadeTo(0,0).delay(100).fadeTo(200,1)},renderContentForGallery:function(){var t=this,o=t.element.find(".image-container"),n=t.element.find(".image-collage");n.outerWidth(t.element.find(".ajax-filelist").width()-1,!0);var i=t.element.attr("data-targetheight");n.removeWhitespace().collagePlus({targetHeight:i,fadeSpeed:"slow",allowPartialLastRow:!0}),t.element.find(".image-container.hidden").fadeOut(0),n.fadeTo(200,1),o.each(function(){var t=e(this).find(".folder-thumb");e(this).find(".image-folder-img").width(e(this).width()).height(e(this).height()),t.length>0&&(t.width(e(this).width()).height(e(this).height()),e(this).find(".image-folder-img").hide())})},fitEntriesInContainer:function(t,o){var n=t.innerWidth()-1,i=Math.round(n/o),a=Math.floor(n/i);t.removeWhitespace(),t.find(".entry_block").each(function(){var t=parseInt(e(this).css("padding-left"))+parseInt(e(this).css("padding-right"));e(this).parent().outerWidth(a-t,!0)})},_initImageFolderThumbActions:function(){var t=this;t.element.on({mousemove:function(t){var o=e(this).find(".folder-thumb"),n=t.offsetX/t.currentTarget.offsetWidth,i=Math.ceil(n*o.length)-1;o.filter(":gt(0)").stop(!0).fadeOut().filter(":eq("+i+")").stop(!0).fadeIn()},mouseleave:function(){e(this).find(".folder-thumb:gt(0)").stop(!0).fadeOut()}},".image-folder")},_initLoadMore:function(){var e=this,t=e.element.find(".image-container.entry:not(.hidden):last()"),o=e.element.attr("data-loadimages");t.one("inview",function(t,n){var i=e.element.find(".image-container:hidden:lt("+o+")");0!==i.length&&(i.fadeIn(500).removeClass("hidden").find("img").removeClass("hidden"),e._initLoadMore())})},_initScrollToTop:function(){var t=this,o=t.element.find(".ajax-filelist");0!==o.length&&(t.element.on("click",".scroll-to-top",function(o){e("html, body").animate({scrollTop:t.element.offset().top},1500)}),e(window).on("scroll",null,{},function(t){clearTimeout(window.scrollTimer),window.scrollTimer=setTimeout(function(){var t=o.next(".scroll-to-top"),n=o.height(),i=o.offset(),a=i.top+n,l=e(window).scrollTop(),s=l+e(window).height();if(l>i.top&&n>e(window).height()){t.show().fadeIn(40);var r=n,d="50%";a>s&&(r=s-i.top-30,d=0),t.stop().animate({top:Math.round(r-50),right:d})}else t.fadeOut(400)},50)}))},_checkReCaptcha:function(t){return null!==t._cacheGet("WPCP_recaptcha")?t._initiate():"undefined"==typeof grecaptcha?(setTimeout(function(){t._checkReCaptcha(t)},1e3),!1):void grecaptcha.ready(function(){grecaptcha.execute(t.options.recaptcha,{action:"wpcloudplugins"}).then(function(o){void 0===window.wpcp_recaptcha_check&&(window.wpcp_recaptcha_check=e.ajax({type:"POST",url:t.options.ajax_url,data:{action:"letsbox-check-recaptcha",listtoken:t.options.listtoken,response:o,_ajax_nonce:t.options.recaptcha_nonce},dataType:"json"})),window.wpcp_recaptcha_check.then(function(e){if(void 0===e.verified||!0!==e.verified)return t.element.find(".nav-title").html(t.options.str_recaptcha_failed),t.options.loadingContainer.addClass("error"),!1;t._cacheSet("WPCP_recaptcha",{value:!0}),t._initiate()},function(){return t.element.find(".nav-title").html(t.options.str_recaptcha_failed),t.options.loadingContainer.addClass("error"),!1})})})},_initMove:function(){var t=this;return!this.options.mobile&&(0!==this.element.find(".moveable").length&&(this.element.find(".moveable").draggable({stack:".moveable",zIndex:999999,cursor:"move",cursorAt:{top:10,left:10},containment:t.element,helper:function(){var o=t.element.find(".moveable .entry_checkbox input:checked").closest(".moveable");0===o.length&&(o=e(this));var n=e("<div/>").attr("id","dragging_container");return n.append(o.clone()),n},distance:10,delay:100,start:function(t,o){e(this).addClass("isdragged")},stop:function(t,o){var n=e(this);setTimeout(function(){n.removeClass("isdragged")},100)}}),void this.element.find(".folder, .image-folder").droppable({accept:t.element.find(".moveable"),activeClass:"ui-state-hover",hoverClass:"ui-state-active",tolerance:"pointer",drop:function(o,n){t._actionMoveEntry(n.helper.children(),e(this))}})))},_initLinkEvent:function(){var t=this;t.element.find(".entry_linkto").off("click").on("click",function(o){var n=e(this).parent().attr("data-name"),i=e(this).parent().attr("data-id"),a=e(".letsbox .thickbox_opener").find("[data-user-id]").attr("data-user-id"),l=e(".thickbox_opener");return l.hasClass("private-folders-auto")?(l.find(".private-folders-auto-current").val(n),l.find(".private-folders-auto-input-id").val(i),l.find(".private-folders-auto-input-name").val(n),l.find(".private-folders-auto-button").removeClass("disabled").find(".wpcp-spinner").fadeOut(),tb_remove(),o.stopPropagation(),!0):(e.ajax({type:"POST",url:t.options.ajax_url,data:{action:"letsbox-linkusertofolder",id:i,text:n,userid:a,_ajax_nonce:t.options.createlink_nonce},beforeSend:function(){tb_remove(),e(".letsbox .thickbox_opener").find(".wpcp-spinner").show()},complete:function(){e(".wpcp-spinner").hide()},success:function(t){"1"===t?(e(".letsbox .thickbox_opener").parent().find(".column-private_folder").text(n),e(".letsbox .thickbox_opener .unlinkbutton").removeClass("hidden"),e(".letsbox .thickbox_opener .linkbutton").addClass("hidden"),e(".letsbox .thickbox_opener").removeClass("thickbox_opener")):location.reload()},dataType:"text"}),o.stopPropagation(),!0)}),t.element.find(".entry_woocommerce_link").off("click").on("click",function(t){var o=e(this).closest(".entry").attr("data-id"),n=e(this).attr("data-name"),i=null;return tb_remove(),window.top.postMessage({slug:"letsbox",action:"wpcp-select-entry",entry_id:o,entry_name:n,account_id:i},window.location.origin),t.stopPropagation(),!0})},_initEntryMenuActions:function(){var t=this,o='.LetsBox[data-token="'+t.options.listtoken+'"] ';!0!==e(o).data("has_entry_events_added")&&(e(document).on({click:function(t){e(this).toggleClass("menu-opened")}},o+"ul li.has-menu"),e(document).on({click:function(o){tippy.hideAll();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");t._actionPreviewEntry(n,o)}},o+".entry_action_view"),e(document).on({click:function(o){tippy.hideAll();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");if(o.stopPropagation(),!n.hasClass("folder"))return t._actionDownloadEntry(n,o);t._actionDownloadZip([n.attr("data-id")],o)}},o+".entry_action_download"),e(document).on({click:function(o){tippy.hideAll();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");return o.stopPropagation(),t._actionExportEntry(n,o)}},o+".entry_action_export"),e(document).on({click:function(o){tippy.hideAll();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");o.stopPropagation(),tippy.hideAll(),t._actionShareEntry(n,o)}},o+".entry_action_shortlink"),e(document).on({click:function(o){tippy.hideAll();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");n.find(".selected-files:checkbox").prop("checked",!0);var i=t.element.find("input[name='selected-files[]']:checked");t._actionDeleteEntries(i,o)}},o+".entry_action_delete"),e(document).on({click:function(o){tippy.hideAll();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");n.find(".selected-files:checkbox").prop("checked",!0);var i=t.element.find("input[name='selected-files[]']:checked");t._actionMoveEntries(i,o)}},o+".entry_action_move"),e(document).on({click:function(o){tippy.hideAll();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");t._actionCopyEntry(n,o)}},o+".entry_action_copy"),e(document).on({click:function(o){tippy.hideAll();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");t._actionRenameEntry(n,o)}},o+".entry_action_rename"),e(document).on({click:function(o){tippy.hideAll();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");t._actionEditDescriptionEntry(n,o)}},o+".entry_action_description"),e(document).on({click:function(o){tippy.hideAll(),o.stopPropagation();var n=t.element.find(".entry[data-id='"+e(this).closest("[data-id]").attr("data-id")+"']");t._actionCreateDeepLink(n,o)}},o+".entry_action_deeplink"),e(o).data("has_entry_events_added",!0))},_initActionMenu:function(){var t=this,o=t.element[0].querySelectorAll(".entry .entry-action-menu-button");e(o).on("click",function(e){e.stopPropagation()}),tippy(o,{trigger:"click",arrow:!1,offset:0,content:function(t){return e(t).find(".tippy-content-holder").clone(!0).get(0)},maxWidth:350,allowHTML:!0,placement:t.is_rtl?"bottom-end":"bottom-start",appendTo:t.element[0],followCursor:"initial",duration:[300,0],interactive:!0,theme:"wpcloudplugins-"+t.options.content_skin,onShow:function(t){e(t.popper).find(".tippy-content-holder").removeClass("tippy-content-holder");var o=e(t.reference).closest(".entry");o.addClass("hasfocus").addClass("popupopen")},onHide:function(t){e(t.reference).closest(".entry").removeClass("hasfocus").removeClass("popupopen")}})},_initDescriptionBox:function(){var t=this,o=t.element[0].querySelectorAll(".entry .entry-description-button, .entry .entry-tags-button");e(o).on("click",function(e){e.stopPropagation()}),tippy(o,{trigger:"mouseenter focus click",arrow:!1,offset:0,content:function(e){return e.querySelector(".tippy-content-holder").innerHTML},maxWidth:350,allowHTML:!0,placement:"bottom",delay:[100,null],offset:[0,0],interactiveBorder:15,appendTo:t.element[0],moveTransition:"transform 0.2s ease-out",interactive:!0,theme:"wpcloudplugins-"+t.options.content_skin,onShow:function(t){tippy.hideAll(),e(t.reference).closest(".entry").addClass("popupopen")},onHide:function(t){e(t.reference).closest(".entry").removeClass("popupopen")}})},renderBreadCrumb:function(){var t=this,o=t.element.find(".wpcp-breadcrumb");o.asBreadcrumbs("destroy"),o.asBreadcrumbs({namespace:"wpcp",toggleIconClass:"eva eva-arrow-down",dropdownMenuClass:"tippy-content",dropdownItem:function(e,t,o){return o?'<li class="'+e.dropdownItemClass+'"><a href="'+o+'"><i class="eva eva-folder eva-lg"></i>  '+t+"</a></li>":'<li class="'+e.dropdownItemClass+" "+e.dropdownItemDisableClass+'"><a href="#"><i class="eva eva-folder eva-lg"></i>  '+t+"</a></li>"}}),o.on({click:function(t){o.find('li a.folder[href="'+e(this).find("a").attr("href")+'"]').trigger("click"),o.find(".wpcp-dropdown").removeClass("dropdown-open")}},".tippy-content li"),o.on({click:function(e){o.find(".wpcp-dropdown").addClass("dropdown-open")}},".wpcp-toggle"),e(document).on({mouseup:function(e){var t=o.find(".tippy-content");t.is(e.target)||0!==t.has(e.target).length||t.parent().removeClass("open")}})},_initThumbnailsPopup:function(){var t=this,o=t.element[0].querySelectorAll(".entry[data-tooltip]");tippy(o,{arrow:!1,content:function(e){return e.querySelector(".entry_thumbnail-view-center")},maxWidth:t.options.mobile?128:256,allowHTML:!0,placement:"auto",delay:[500,null],offset:[0,10],appendTo:t.element[0],moveTransition:"transform 0.2s ease-out",interactive:!0,theme:"wpcloudplugins-"+t.options.content_skin,onHide:function(t){e(t.reference).removeClass("hasfocus")}})},_initLazyLoad:function(){var t=this;t.lazyload=new LazyLoad({data_src:window.devicePixelRatio>1?"src-retina":"src",elements_selector:"img.preloading",threshold:250,unobserve_entered:!0,use_native:!1,class_applied:"wpcp-lazy-applied",class_loading:"wpcp-lazy-loading",class_loaded:"wpcp-lazy-loaded",class_error:"wpcp-lazy-error",callback_loaded:function(t){e(t).removeClass("preloading").removeAttr("data-src"),e(t).prev(".preloading").remove()},callback_load:function(t){e(t).removeClass("preloading").removeAttr("data-src"),e(t).prev(".preloading").remove()},callback_error:function(t){void 0!==e(t).attr("data-src-backup")&&!1!==e(t).attr("data-src-backup")?t.src=e(t).attr("data-src-backup"):t.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=",e(t).removeAttr("data-src"),e(t).prev(".preloading").remove()}})},_initNavMenu:function(){var e=this;this._initSearchBox(),this._initNavActionMenu(),this._initSortMenu(),e.element.on({click:function(t){e.clearSearchBox(),e.options.forceRefresh=!0,e._getFileList({})}},".nav-refresh"),e.element.on({click:function(t){e.clearSearchBox(),e.element.attr("data-id",e.element.attr("data-org-id")).attr("data-path",""),e._getFileList({lastFolder:e.element.attr("data-org-id")})}},".nav-home")},_initLightbox:function(){var t,o,n=this,i="1"===n.element.attr("data-lightboxnav"),a=!1,l=!1,s=!1,r=!1;n.options.lightbox_showheader=n.options.topContainer.hasClass("files")?"true":n.options.lightbox_showheader,"click"===n.options.lightbox_showheader?t=l="click":"mouseenter"===n.options.lightbox_showheader?(t=n.options.lightbox_showheader,l="mouseleave"):"false"==n.options.lightbox_showheader?(t=!1,l=!1):(a=!0,t=!0,l=!0),"click"===n.options.lightbox_showcaption?o=r="click":"mouseenter"===n.options.lightbox_showcaption?(o=n.options.lightbox_showcaption,r="mouseleave"):"false"==n.options.lightbox_showcaption?(o=!1,r=!1):(s=!0,o=!0,r=!0);var d={WPCP:this,skin:this.options.lightbox_skin,path:this.options.lightbox_path,maxScale:1,minScale:.05,infinite:!0,slideshow:{pauseOnHover:!1,pauseTime:n.element.attr("data-pausetime"),startPaused:"gallery"!==n.element.attr("data-list")||"1"!==n.element.attr("data-slideshow")},controls:{slideshow:!("gallery"!==n.element.attr("data-list")||!i),arrows:!!i},caption:{start:s,show:o,hide:r},headerHeight:50,header:{start:a,show:t,hide:l},thumbnails:{normalOpacity:.4,activeOpacity:1,maxHeight:100},overlay:{opacity:"gallery"===n.element.attr("data-list")?1:.85},keepAspectRatio:!0,callback:{onBeforeLoad:function(t,o){e(".ilightbox-holder").addClass("LetsBox").attr("data-token",n.options.listtoken),e(".ilightbox-holder .lb-hidepopout").remove();var i=e(".ilightbox-holder").find("iframe").addClass("lb-embedded");"0"===n.element.attr("data-popout")&&e(".ilightbox-holder").find(".lb-embedded").after('<div class="lb-hidepopout">&nbsp;</div>'),n._helperIframeFix(i)},onBeforeChange:function(t){var o=e(".ilightbox-holder video, .ilightbox-holder audio");e.each(o,function(e,t){!1===t.paused&&t.pause()})},onAfterChange:function(t){var o=t.currentElement.find("video, audio");e.each(o,function(e,t){t.paused&&t.play()})},onRender:function(t,o){var n=e(".ilightbox-holder").find("video, audio");e.each(n,function(t,o){var n=e(this);e(this).find("source").attr("src",n.find("source").attr("data-src"))})},onShow:function(t){0===t.currentElement.find(".empty_iframe").length&&t.currentElement.find(".lb-embedded").after(n.options.str_iframe_loggedin),t.currentElement.find("iframe").length>0&&t.currentElement.find("iframe").on("load",function(){t.currentElement.find(".empty_iframe").remove()}),t.currentElement.find(".empty_iframe").hide(),0===t.currentElement.find("img").length&&setTimeout(function(){t.currentElement.find(".empty_iframe").fadeIn(),t.currentElement.find(".empty_iframe_link").attr("href",t.currentElement.find("iframe").attr("src"))},5e3);var o=t.currentElement.find("video, audio");e.each(o,function(e,t){t.paused&&t.play()});var i=this;new LazyLoad({data_src:window.devicePixelRatio>1?"src-retina":"src",unobserve_entered:!0,use_native:!1,elements_selector:".ilightbox-thumbnail img.preloading",class_applied:"wpcp-lazy-applied",class_loading:"wpcp-lazy-loading",class_loaded:"wpcp-lazy-loaded",class_error:"wpcp-lazy-error",callback_loaded:function(t){e(t).removeClass("preloading preloading-lightbox-thumbnail"),e(t).prev(".preloading").remove(),e(t).parent().data({naturalWidth:t.width,naturalHeight:t.height}),i.positionThumbnails(null,null,null)},callback_load:function(t){e(t).removeClass("preloading preloading-lightbox-thumbnail"),e(t).prev(".preloading").remove(),
e(t).parent().data({naturalWidth:t.width,naturalHeight:t.height}),i.positionThumbnails(null,null,null)}}),e(".ilightbox-container .lb-hidepopout").on("contextmenu",function(e){return!1}),e(".ilightbox-container .ilightbox-wrapper, .ilightbox-container img, .ilightbox-container video, .ilightbox-container audio").on("contextmenu",function(e){return"Yes"===n.options.lightbox_rightclick});var a=t.currentElement.find("[src]");if(a.length>0&&1!==a.data("logged")){var l=e('a[href="'+a.attr("src")+'"]').closest(".entry").data("id");a.data("logged",1),n._logEvent("log_preview_event",l)}}},errors:{loadImage:n.options.str_imgError_title,loadContents:n.options.str_xhrError_title},text:{next:n.options.str_next_title,previous:n.options.str_previous_title,slideShow:n.options.str_startslideshow}};if(i){e.isEmptyObject(this.lightBox)||n.lightBox.destroy();var c=n.element.find(".ilightbox-group");n.lightBox=c.WPCP_iLightBox(d)}else e.isEmptyObject(this.lightBox)||e.each(this.lightBox,function(){this.destroy()}),n.lightBox=[],n.element.find(".ilightbox-group").each(function(){n.lightBox.push(e(this).WPCP_iLightBox(d))})},_actionCreateDeepLink:function(t){var o=this,n=t.attr("data-id"),i=o.element.find(".entry[data-id='"+n+"']").attr("data-name"),a=t.find("img").attr("src"),l=o.element.find(".entry[data-id='"+n+"']").hasClass("folder")||o.element.find(".entry[data-id='"+n+"']").hasClass("image-folder");if(t.hasClass("entry_action_deeplink_folder"))n=o.element.attr("data-id");var s={source:o.element.attr("data-source"),lastFolder:l?n:o.element.attr("data-id"),folderPath:o.element.attr("data-path"),focus_id:n},r=window.btoa(encodeURIComponent(JSON.stringify(s))),d=new URL(window.location),c=new URLSearchParams(d.search);c.set("wpcp_link",r),d.search=c.toString(),e("#letsbox-modal-action").remove();var p="";p+='<button class="button letsbox-modal-cancel-btn secondary" data-action="cancel" type="button" onclick="modal_action.close();" title="'+o.options.str_close_title+'" >'+o.options.str_close_title+"</button>",p+='<button class="button letsbox-modal-confirm-btn" data-action="confirm" type="button" title="'+o.options.str_create_shared_link+'" >'+o.options.str_create_shared_link+"</button>";var m=e('<a tabindex="0" class="close-button" title="'+o.options.str_close_title+'" onclick="modal_action.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a></div>'),u=e('<div class="letsbox-modal-body" tabindex="0" ></div>'),h=e('<div class="letsbox-modal-footer"><div class="letsbox-modal-buttons">'+p+"</div></div>"),f=e('<div id="letsbox-modal-action" class="LetsBox letsbox-modal '+o.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');e("body").append(f),e("#letsbox-modal-action .modal-content").append(m,u,h),e.ajax({type:"POST",url:o.options.ajax_url,data:{action:"letsbox-shorten-url",listtoken:o.options.listtoken,id:n,url:d.toString(),_ajax_nonce:o.options.shortenurl_nonce},complete:function(){e("#letsbox-modal-action .letsbox-modal-confirm-btn").remove()},success:function(t){if(null!==t)if(null!==t.url){e(".letsbox-modal-body").append('<input type="text" class="shared-link-url" value="'+t.url+'" style="width: 98%;" readonly/><div class="shareon letsbox-shared-social"></div>'),sendAnalyticsLB("Create deeplink",i);var n=e("#letsbox-modal-action .letsbox-shared-social");n.attr("data-url",t.url),n.attr("data-title",i+" | "),e.each(o.options.share_buttons,function(e,t){n.append('<a class="'+t+'" title="'+o.options.str_shareon+" "+t.charAt(0).toUpperCase()+t.slice(1)+'" data-media="'+a+'" data-imageurl="'+a+'" data-image="'+a+'"></a>')}),Shareon.init();e(".shareon .email").attr("href","mailto:?subject="+i+" | &body="+t.url);var l=new ClipboardJS(".shareon .clipboard",{text:function(t){return e(".shared-link-url").val()}});l.on("success",function(t){e(".shareon .clipboard").addClass("clipboard-check"),t.clearSelection()}),l.on("error",function(){o.options.mobile?e(".shared-link-url").select():window.prompt("Copy to clipboard: Ctrl+C, Enter",e(".shared-link-url").val())})}else e(".letsbox-modal-body").find(".shared-link-url").val(t.error)},dataType:"json"});var v=new RModal(document.getElementById("letsbox-modal-action"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){v.keydown(e)},!1),v.open(),window.modal_action=v,e("#letsbox-modal-action .letsbox-modal-confirm-btn").prop("disabled",!0),e("#letsbox-modal-action .letsbox-modal-confirm-btn").html('<i class="eva eva-settings-outline eva-spin eva-fw"></i><span> '+o.options.str_processing+"</span>"),!1},_logEvent:function(t,o,n){var i=this;if("0"===i.options.log_events)return!1;void 0===n&&(n={}),e.ajax({type:"POST",url:i.options.ajax_url,data:{action:"letsbox-event-log",listtoken:i.options.listtoken,type:t,id:o,data:n,_ajax_nonce:i.options.log_nonce}})},_actionPreviewEntry:function(e,t){var o=this,n=e.find(".entry_link");o.options.supportTouch&&n.hasClass("ilightbox-group")?n.trigger("itap"):n[0].click()},_actionDownloadEntry:function(t,o){sendAnalyticsLB("Download",t.attr("data-name"));var n=e('<div><i class="eva eva-settings-outline eva-spin eva-1x eva-fw"></i></div>').css({"margin-right":"5px",display:"inline-grid"}).delay(5e3).fadeOut("slow",function(){e(this).remove()});t.find(".entry-info-name span").prepend(n),setTimeout(function(){return!0},300)},_actionDownloadZip:function(t,o){var n=this;e("#letsbox-modal-action").remove(),n._zipDownload(t)},_zipDownload:function(t){var o=this,n={action:"letsbox-create-zip",type:"do-zip",account_id:o.options.account_id,listtoken:o.options.listtoken,lastFolder:o.element.attr("data-id"),_ajax_nonce:o.options.createzip_nonce,files:t};o._helperDownloadUrlInline(o.options.ajax_url+"?"+e.param(n))},_actionExportEntry:function(e,t){return sendAnalyticsLB("Export",e.attr("data-name")),setTimeout(function(){return!0},300),!1},_actionShareEntry:function(t,o){var n=this,i=t.attr("data-id"),a=t.attr("data-name"),l=t.find("img").attr("src");if(t.hasClass("entry_action_shortlink_folder"))i=n.element.attr("data-id");e("#letsbox-modal-action").remove();var s="";s+='<button class="button letsbox-modal-cancel-btn secondary" data-action="cancel" type="button" onclick="modal_action.close();" title="'+n.options.str_close_title+'" >'+n.options.str_close_title+"</button>",s+='<button class="button letsbox-modal-confirm-btn" data-action="confirm" type="button" title="'+n.options.str_create_shared_link+'" >'+n.options.str_create_shared_link+"</button>";var r=e('<a tabindex="0" class="close-button" title="'+n.options.str_close_title+'" onclick="modal_action.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a></div>'),d=e('<div class="letsbox-modal-body" tabindex="0" ></div>'),c=e('<div class="letsbox-modal-footer"><div class="letsbox-modal-buttons">'+s+"</div></div>"),p=e('<div id="letsbox-modal-action" class="LetsBox letsbox-modal '+n.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');e("body").append(p),e("#letsbox-modal-action .modal-content").append(r,d,c),e.ajax({type:"POST",url:n.options.ajax_url,data:{action:"letsbox-create-link",listtoken:n.options.listtoken,id:i,_ajax_nonce:n.options.createlink_nonce},complete:function(){e("#letsbox-modal-action .letsbox-modal-confirm-btn").remove()},success:function(t){if(null!==t)if(null!==t.link){e(".letsbox-modal-body").append('<input type="text" class="shared-link-url" value="'+t.link+'" style="width: 98%;" readonly/><div class="shareon letsbox-shared-social"></div>'),sendAnalyticsLB("Create shared link",a);var o=e("#letsbox-modal-action .letsbox-shared-social");o.attr("data-url",t.link),o.attr("data-title",a+" | "),e.each(n.options.share_buttons,function(e,t){o.append('<a class="'+t+'" title="'+n.options.str_shareon+" "+t.charAt(0).toUpperCase()+t.slice(1)+'" data-media="'+l+'" data-imageurl="'+l+'" data-image="'+l+'"></a>')}),Shareon.init();e(".shareon .email").attr("href","mailto:?subject="+a+" | &body="+t.link);var i=new ClipboardJS(".shareon .clipboard",{text:function(t){return e(".shared-link-url").val()}});i.on("success",function(t){e(".shareon .clipboard").addClass("clipboard-check"),t.clearSelection()}),i.on("error",function(){n.options.mobile?e(".shared-link-url").select():window.prompt("Copy to clipboard: Ctrl+C, Enter",e(".shared-link-url").val())})}else e(".letsbox-modal-body").find(".shared-link-url").val(t.error)},dataType:"json"});var m=new RModal(document.getElementById("letsbox-modal-action"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){m.keydown(e)},!1),m.open(),window.modal_action=m,e("#letsbox-modal-action .letsbox-modal-confirm-btn").prop("disabled",!0),e("#letsbox-modal-action .letsbox-modal-confirm-btn").html('<i class="eva eva-settings-outline eva-spin eva-fw"></i><span> '+n.options.str_processing+"</span>"),!1},_actionCreateEntry:function(t,o,n){var i=this;e("#letsbox-modal-action").remove();var a="";a+='<button class="button letsbox-modal-cancel-btn secondary" data-action="cancel" type="button" onclick="modal_action.close();" title="'+i.options.str_cancel_title+'" >'+i.options.str_cancel_title+"</button>",a+='<button class="button letsbox-modal-confirm-btn" data-action="rename" type="button" title="'+i.options.str_addnew_title+'" >'+i.options.str_addnew_title+"</button>";var l='<input type="text" id="letsbox-modal-create-entry-input" name="letsbox-modal-create-entry-input" value="" style="width:100%"/>',s=e('<a tabindex="0" class="close-button" title="'+i.options.str_close_title+'" onclick="modal_action.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a></div>'),r=e('<div class="letsbox-modal-body" tabindex="0" >'+i.options.str_addnew_name+": <br/>"+l+"</div>"),d=e('<div class="letsbox-modal-footer"><div class="letsbox-modal-buttons">'+a+"</div></div>"),c=e('<div id="letsbox-modal-action" class="LetsBox letsbox-modal '+i.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');e("body").append(c),e("#letsbox-modal-action .modal-content").append(s,r,d),e("#letsbox-modal-action #letsbox-modal-create-entry-input").on("keyup",function(t){13!=t.which&&13!=t.keyCode||e("#letsbox-modal-action .letsbox-modal-confirm-btn").trigger("click")}),e("#letsbox-modal-action .letsbox-modal-confirm-btn").on("click",function(t){var n=e("#letsbox-modal-create-entry-input").val();if(/[<>:"/\\|?*]/g.test(e("#letsbox-modal-create-entry-input").val()))e("#letsbox-modal-action .letsbox-modal-error").remove(),e("#letsbox-modal-create-entry-input").after('<div class="letsbox-modal-error">'+i.options.str_rename_failed+"</div>"),e("#letsbox-modal-action .letsbox-modal-error").fadeIn();else{var a={action:"letsbox-create-entry",mimetype:o,name:encodeURIComponent(n),_ajax_nonce:i.options.createentry_nonce};i._actionDoModifyEntry(a),e("#letsbox-modal-action .letsbox-modal-confirm-btn").prop("disabled",!0),e("#letsbox-modal-action .letsbox-modal-confirm-btn").html('<i class="eva eva-settings-outline eva-spin eva-fw"></i><span> '+i.options.str_processing+"</span>")}});var p=new RModal(document.getElementById("letsbox-modal-action"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){p.keydown(e)},!1),p.open(),window.modal_action=p,!1},_actionCopyEntry:function(t,o){var n=this,i=t.attr("data-id"),a=t.attr("data-name");e("#letsbox-modal-action").remove();var l="";l+='<button class="button letsbox-modal-cancel-btn secondary" data-action="cancel" type="button" onclick="modal_action.close();" title="'+n.options.str_cancel_title+'" >'+n.options.str_cancel_title+"</button>",l+='<button class="button letsbox-modal-confirm-btn" data-action="rename" type="button" title="'+n.options.str_copy_title+'" >'+n.options.str_copy_title+"</button>";var s='<input id="letsbox-modal-rename-input" name="letsbox-modal-rename-input" type="text" value="'+a+' (1)" style="width:100%"/>',r=e('<a tabindex="0" class="close-button" title="'+n.options.str_close_title+'" onclick="modal_action.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a></div>'),d=e('<div class="letsbox-modal-body" tabindex="0" >'+n.options.str_copy+"<br/>"+s+"</div>"),c=e('<div class="letsbox-modal-footer"><div class="letsbox-modal-buttons">'+l+"</div></div>"),p=e('<div id="letsbox-modal-action" class="LetsBox letsbox-modal '+n.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');e("body").append(p),e("#letsbox-modal-action .modal-content").append(r,d,c),e("#letsbox-modal-action #letsbox-modal-rename-input").on("keyup",function(t){13!=t.which&&13!=t.keyCode||e("#letsbox-modal-action .letsbox-modal-confirm-btn").trigger("click")}),e("#letsbox-modal-action .letsbox-modal-confirm-btn").on("click",function(t){var o=e("#letsbox-modal-rename-input").val();if(/[<>:"/\\|?*]/g.test(e("#letsbox-modal-rename-input").val()))e("#letsbox-modal-action .letsbox-modal-error").remove(),e("#letsbox-modal-rename-input").after('<div class="letsbox-modal-error">'+n.options.str_rename_failed+"</div>"),e("#letsbox-modal-action .letsbox-modal-error").fadeIn();else{var a={action:"letsbox-copy-entry",id:i,newname:encodeURIComponent(o),_ajax_nonce:n.options.copy_nonce};n._actionDoModifyEntry(a),e("#letsbox-modal-action .letsbox-modal-confirm-btn").prop("disabled",!0),e("#letsbox-modal-action .letsbox-modal-confirm-btn").html('<i class="eva eva-settings-outline eva-spin eva-fw"></i><span> '+n.options.str_processing+"</span>")}});var m=new RModal(document.getElementById("letsbox-modal-action"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){m.keydown(e)},!1),m.open(),window.modal_action=m,!1},_actionRenameEntry:function(t,o){var n=this,i=t.attr("data-id"),a=t.attr("data-name");e("#letsbox-modal-action").remove();var l="";l+='<button class="button letsbox-modal-cancel-btn secondary" data-action="cancel" type="button" onclick="modal_action.close();" title="'+n.options.str_cancel_title+'" >'+n.options.str_cancel_title+"</button>",l+='<button class="button letsbox-modal-confirm-btn" data-action="rename" type="button" title="'+n.options.str_rename_title+'" >'+n.options.str_rename_title+"</button>";var s='<input id="letsbox-modal-rename-input" name="letsbox-modal-rename-input" type="text" value="'+a+'" style="width:100%"/>',r=e('<a tabindex="0" class="close-button" title="'+n.options.str_close_title+'" onclick="modal_action.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a></div>'),d=e('<div class="letsbox-modal-body" tabindex="0" >'+n.options.str_rename+"<br/>"+s+"</div>"),c=e('<div class="letsbox-modal-footer"><div class="letsbox-modal-buttons">'+l+"</div></div>"),p=e('<div id="letsbox-modal-action" class="LetsBox letsbox-modal '+n.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');e("body").append(p),e("#letsbox-modal-action .modal-content").append(r,d,c),e("#letsbox-modal-action #letsbox-modal-rename-input").on("keyup",function(t){13!=t.which&&13!=t.keyCode||e("#letsbox-modal-action .letsbox-modal-confirm-btn").trigger("click")}),e("#letsbox-modal-action .letsbox-modal-confirm-btn").on("click",function(t){var o=e("#letsbox-modal-rename-input").val();if(/[<>:"/\\|?*]/g.test(e("#letsbox-modal-rename-input").val()))e("#letsbox-modal-action .letsbox-modal-error").remove(),e("#letsbox-modal-rename-input").after('<div class="letsbox-modal-error">'+n.options.str_rename_failed+"</div>"),e("#letsbox-modal-action .letsbox-modal-error").fadeIn();else{var a={action:"letsbox-rename-entry",id:i,newname:encodeURIComponent(o),_ajax_nonce:n.options.rename_nonce};n._actionDoModifyEntry(a),e("#letsbox-modal-action .letsbox-modal-confirm-btn").prop("disabled",!0),e("#letsbox-modal-action .letsbox-modal-confirm-btn").html('<i class="eva eva-settings-outline eva-spin eva-fw"></i><span> '+n.options.str_processing+"</span>")}});var m=new RModal(document.getElementById("letsbox-modal-action"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){m.keydown(e)},!1),m.open(),window.modal_action=m,!1},_actionEditDescriptionEntry:function(t,o){var n=this,i=t.attr("data-id"),a=t.find(".description-text").html();void 0===a&&(a=""),e("#letsbox-modal-action").remove();var l="";l+='<button class="button letsbox-modal-cancel-btn secondary" data-action="cancel" type="button" onclick="modal_action.close();" title="'+n.options.str_cancel_title+'" >'+n.options.str_cancel_title+"</button>",l+='<button class="button letsbox-modal-confirm-btn" data-action="editdescription" type="button" title="'+n.options.str_save_title+'" >'+n.options.str_save_title+"</button>";var s=e('<a tabindex="0" class="close-button" title="'+n.options.str_close_title+'" onclick="modal_action.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a></div>'),r=e('<div class="letsbox-modal-body" tabindex="0" ><textarea id="letsbox-modal-description-input" name="letsbox-modal-description-input" style="width:100%" rows="8" placeholder="'+n.options.str_add_description+'"></textarea></div>'),d=e('<div class="letsbox-modal-footer"><div class="letsbox-modal-buttons">'+l+"</div></div>"),c=e('<div id="letsbox-modal-action" class="LetsBox letsbox-modal '+n.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');e("body").append(c),e("#letsbox-modal-action .modal-content").append(s,r,d),e("#letsbox-modal-description-input").val(a.replace(/<br\s?\/?>/g,"\r")),e("#letsbox-modal-action #letsbox-modal-description-input").on("keyup",function(t){13!=t.which&&13!=t.keyCode||e("#letsbox-modal-action .letsbox-modal-description-btn").trigger("click")}),e("#letsbox-modal-action .letsbox-modal-confirm-btn").on("click",function(t){var o=e("#letsbox-modal-description-input").val(),a={action:"letsbox-edit-description-entry",id:i,newdescription:o,listtoken:n.options.listtoken,_ajax_nonce:n.options.description_nonce};n._actionDoModifyEntry(a),e("#letsbox-modal-action .letsbox-modal-confirm-btn").prop("disabled",!0),e("#letsbox-modal-action .letsbox-modal-confirm-btn").html('<i class="eva eva-settings-outline eva-spin eva-fw"></i><span> '+n.options.str_processing+"</span>")});var p=new RModal(document.getElementById("letsbox-modal-action"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){p.keydown(e)},!1),p.open(),window.modal_action=p,!1},_actionMoveEntry:function(t,o,n){var i=this,a=[];e.each(t,function(){a.push(e(this).attr("data-id"))});var l={action:"letsbox-move-entries",entries:a,copy:!1,target:o.attr("data-id"),_ajax_nonce:i.options.move_nonce};i._actionDoModifyEntry(l)},_actionMoveEntries:function(t,o){e("#letsbox-modal-action").remove();var n=this,i=[];e.each(t,function(){i.push(e(this).val())});var a="";a+='<button class="button letsbox-modal-cancel-btn secondary" data-action="cancel" type="button" onclick="modal_action.close();" title="'+n.options.str_cancel_title+'" >'+n.options.str_cancel_title+"</button>",a+='<button class="button letsbox-modal-confirm-btn" data-action="confirm" type="button" title="'+n.options.str_move_title+'" >'+n.options.str_move_title+" ("+i.length+")</button>";var l=e('<a tabindex="0" class="close-button" title="'+n.options.str_close_title+'" onclick="modal_action.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a></div>'),s=e('<div class="letsbox-modal-body" tabindex="0" ><div id="letsbox-modal-folder-selector"></div></div>'),r=e('<div class="letsbox-modal-footer"><div class="letsbox-modal-buttons">'+a+"</div></div>"),d=e('<div id="letsbox-modal-action" class="LetsBox letsbox-modal '+n.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');e("body").append(d),e("#letsbox-modal-action .modal-content").append(l,s,r),n.options.topContainer.clone().appendTo("#letsbox-modal-folder-selector").removeClass("gallery").addClass("files"),e("#letsbox-modal-folder-selector").find(".ajax-filelist").html(""),e("#letsbox-modal-folder-selector .LetsBox").attr("data-list","files").attr("data-layout","list").LetsBox(LetsBox_vars),e("#letsbox-modal-action .letsbox-modal-confirm-btn").on("click",function(t){var o={action:"letsbox-move-entries",entries:i,copy:!1,target:e("#letsbox-modal-folder-selector .LetsBox").attr("data-id"),_ajax_nonce:n.options.move_nonce};n._actionDoModifyEntry(o),e("#letsbox-modal-action .letsbox-modal-confirm-btn").prop("disabled",!0),e("#letsbox-modal-action .letsbox-modal-confirm-btn").html('<i class="eva eva-settings-outline eva-spin eva-fw"></i><span> '+n.options.str_processing+"</span>")});var c=new RModal(document.getElementById("letsbox-modal-action"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){c.keydown(e)},!1),c.open(),window.modal_action=c,!1},_actionDeleteEntries:function(t,o){e("#letsbox-modal-action").remove();var n=this,i="",a=[];e.each(t,function(){var t=e(this).closest(".entry"),o=t.find("img:first()"),n=e('<div class="letsbox-modal-file-icon">');o.length>0&&o.clone().appendTo(n),i+="<li>"+n.html()+"<span>"+t.attr("data-name")+"</span></li>",a.push(e(this).val())});var l="";l+='<button class="button letsbox-modal-cancel-btn secondary" data-action="cancel" type="button" onclick="modal_action.close();" title="'+n.options.str_cancel_title+'" >'+n.options.str_cancel_title+"</button>",l+='<button class="button letsbox-modal-confirm-btn" data-action="confirm" type="button" title="'+n.options.str_delete_title+'" >'+n.options.str_delete_title+" ("+a.length+") </button>";var s=e('<a tabindex="0" class="close-button" title="'+n.options.str_close_title+'" onclick="modal_action.close();"><i class="eva eva-close eva-lg" aria-hidden="true"></i></a></div>'),r=e('<div class="letsbox-modal-body" tabindex="0" >'+n.options.str_delete+'</br></br><ul class="files">'+i+"</ul></div>"),d=e('<div class="letsbox-modal-footer"><div class="letsbox-modal-buttons">'+l+"</div></div>"),c=e('<div id="letsbox-modal-action" class="LetsBox letsbox-modal '+n.options.content_skin+'"><div class="modal-dialog"><div class="modal-content"></div></div></div>');e("body").append(c),e("#letsbox-modal-action .modal-content").append(s,r,d),e("#letsbox-modal-action .letsbox-modal-confirm-btn").on("click",function(t){var o={action:"letsbox-delete-entries",entries:a,_ajax_nonce:n.options.delete_nonce};n._actionDoModifyEntry(o),e("#letsbox-modal-action .letsbox-modal-confirm-btn").prop("disabled",!0),e("#letsbox-modal-action .letsbox-modal-confirm-btn").html('<i class="eva eva-settings-outline eva-spin eva-fw"></i><span> '+n.options.str_processing+"</span>")});var p=new RModal(document.getElementById("letsbox-modal-action"),{bodyClass:"rmodal-open",dialogOpenClass:"animated slideInDown",dialogCloseClass:"animated slideOutUp",escapeClose:!0});return document.addEventListener("keydown",function(e){p.keydown(e)},!1),p.open(),window.modal_action=p,!1},_actionDoModifyEntry:function(t){var o=this,n=o.element.attr("data-id");t.listtoken=this.options.listtoken,t.lastFolder=n,e.ajax({type:"POST",url:o.options.ajax_url,data:t,beforeSend:function(){o.options.loadingContainer.fadeIn(400)},success:function(e){void 0!==e&&void 0!==e.lastFolder&&null!==e.lastFolder&&o.element.attr("data-id",e.lastFolder)},complete:function(){"undefined"!=typeof modal_action&&modal_action.close(),o.options.forceRefresh=!0,o._getFileList({})},dataType:"json"})},_initResizeHandler:function(){var t=this;t._orgininal_width=t.element.width(),e(window).resize(function(){t._orgininal_width!==t.element.width()&&(t._orgininal_width=t.element.width(),t._refreshView())})},_refreshView:function(){var e=this;void 0!==e.resizeTimer&&clearTimeout(e.resizeTimer),e.element.find(".image-collage").fadeTo(100,0),e.element.find(".files").fadeTo(100,0),e.resizeTimer=setTimeout(function(){(e.options.topContainer.hasClass("files")||e.options.topContainer.hasClass("search"))&&e.renderContentForBrowser(),e.options.topContainer.hasClass("gallery")&&e.renderContentForGallery()},100)},_pipeline:function(t){var o=this,n=e.extend({url:o.options.ajax_url,data:null,method:"POST"},t);return function(t,i){var a=n.data(t);e.extend(t,a);var l=t.listtoken+t._ajax_nonce+(void 0===t.id?t.lastFolder:t.id)+t.sort+t.query,s="WPCP_"+l.hashCode();if(o.options.clearLocalCache&&(o._cacheRemove("all"),o.options.clearLocalCache=!1),o.options.forceRefresh&&(o._cacheRemove("all"),t.hardrefresh=!0,o.options.forceRefresh=!1),null!==o._cacheGet(s)){var r=o._cacheGet(s);if(r===Object(r))return r.draw=t.draw,o.renderBrowserContent(r),!0;o._cacheRemove(s)}void 0!==i.jqXHR&&null!==i.jqXHR&&i.jqXHR.abort(),i.jqXHR=e.ajax({type:n.method,url:n.url,data:t,dataType:"json",cache:!1,beforeSend:function(){},success:function(e){if(e!==Object(e))return o.element.trigger("ajax-error",[e,t,i.jqXHR]),o.renderBrowserContent(!1),!1;o.element.trigger("ajax-success",[e,t,i.jqXHR]);var n=new Date;n.setMinutes(n.getMinutes()+5),e.expires=n.getTime(),o._cacheSet(s,e),o.renderBrowserContent(e)},error:function(e){return o.element.trigger("ajax-error",[e,t,i.jqXHR]),(void 0===t.query||""===t.query||0!==i.jqXHR.status||"abort"!==i.jqXHR.statusText)&&(o.renderBrowserContent(!1),!1)}})}},_initCache:function(){var e=this;e._isCacheStorageAvailable=e._cacheStorageAvailable(),setInterval(function(){e._cacheRemove("all")},9e5)},_cacheStorageAvailable:function(){try{var e=window.sessionStorage,t="__storage_test__";return e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}},_cacheGet:function(e){var t;if(this._isCacheStorageAvailable)t=JSON.parse(sessionStorage.getItem(e));else{if(void 0===this.cache[e])return null;t=this.cache[e]}if(null===t)return t;if(void 0===t.expires){var o=new Date;o.setMinutes(o.getMinutes()+5),t.expires=o.getTime()}return null!==t.expires&&t.expires<(new Date).getTime()?(this._cacheRemove(e),null):t},_cacheSet:function(e,t){if(this._isCacheStorageAvailable)try{sessionStorage.setItem(e,JSON.stringify(t))}catch(e){return this._cacheRemove("all"),!1}else void 0===this.cache[e]&&(this.cache[e]={}),this.cache[e]=t},_cacheRemove:function(e){if(this._isCacheStorageAvailable)if("all"===e)for(var t=sessionStorage.length;t--;){e=sessionStorage.key(t);/WPCP/.test(e)&&sessionStorage.removeItem(e)}else sessionStorage.removeItem(e);else"all"===e?delete this.cache:delete this.cache[e]},_helperDownloadUrlInline:function(e){var t="hiddenDownloader",o=document.getElementById(t);null===o&&(o=document.createElement("iframe"),o.id=t,o.style.display="none",document.body.appendChild(o)),o.src=e},_helperFormatBytes:function(e,t){if(0==e)return"—";var o=1e3,n=t+1||3,i=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],a=Math.floor(Math.log(e)/Math.log(o));return parseFloat((e/Math.pow(o,a)).toFixed(n))+" "+i[a]},_helperReturnBytes:function(e){if(""==e)return 0;var t=e.charAt(e.length-1);switch("B"!==t&&"b"!==t||!isNaN(e.charAt(e.length-2))||(t=e.charAt(e.length-2)),t){case"M":case"m":return 1048576*parseInt(e);case"k":case"k":return 1024*parseInt(e);case"G":case"g":return 1073741824*parseInt(e);default:return parseInt(e)}},_helperIframeFix:function(t){/iPhone|iPod|iPad/.test(navigator.userAgent)&&t.each(function(){0===e(this).closest("#safari_fix").length&&e(this).wrap(function(){return e('<div id="safari_fix"/>').css({width:"100%",height:"100%",overflow:"auto","z-index":"2","-webkit-overflow-scrolling":"touch"})})})},_helperCachedScript:function(e,t){return t=jQuery.extend(t||{},{dataType:"script",cache:!0,url:e}),jQuery.ajax(t)},_helperReadArrCheckBoxes:function(t){var o=e(t+":checked").map(function(){return this.value}).get();return o},_helperIsIE:function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("msie")&&parseInt(e.split("msie")[1])}});var t=e({});e.ajaxQueue=function(o){var n=o.complete;t.queue(function(t){o.complete=function(){n&&n.apply(this,arguments),t()},e.ajax(o)})}}),jQuery(document).ready(function(e){e("div.LetsBox").LetsBox(LetsBox_vars)});var WPCP_LetsBox_mutationCallback=function(e,t){for(var o in e)if("childList"===o.type)for(var n in o.addedNodes)n instanceof HTMLElement&&n.matches('div[id*="LetsBox-"]')&&jQuery(n).LetsBox(LetsBox_vars)},WPCP_LetsBox_mutationObserver=new MutationObserver(WPCP_LetsBox_mutationCallback);WPCP_LetsBox_mutationObserver.observe(document.documentElement,{childList:!0,subtree:!0});